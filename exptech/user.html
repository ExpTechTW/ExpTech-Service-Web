<html lang="zh-Hant">

<head>
    <title id="title">TREM Service Panel</title>
    <meta charset="utf-8" />
    <meta content="ExpTech Studio" property="og:title" />
    <meta content="ExpTech | 探索科技 | 用戶資訊面板" property="og:description" />
    <meta content="https://exptech.com.tw/api/v1/file/exptech/index.html" property="og:url" />
    <meta content="https://raw.githubusercontent.com/ExpTechTW/ExpTechTW.github.io/master/image/main/ExpTech.jpg"
        property="og:image" />
</head>

<body style="background-color: #333439;">
    <div class="main">
        <div>硬幣: <a id="coin"></a></div>
        <div>WebSocket 數量: <a id="client"></a></div>
        <div><a id="service"></a></div>
        <div><a id="subscribe"></a></div>
        <div><a id="key"></a></div>
        <div><a id="key_list"></a></div>
        <div><a id="client_list"></a></div>
    </div>

    <style>
        @import url(https://fonts.googleapis.com/earlyaccess/cwtexyen.css);

        html,
        body {
            font-family: "cwTeXYen", sans-serif;
        }

        .main {
            font-size: 30px;
            color: white;
        }
    </style>

    <script>
        const urlSearchParams = new URLSearchParams(window.location.search);
        const params = Object.fromEntries(urlSearchParams.entries());

        if (!params.token) window.location.href = './login.html';

        function load() {
            fetch(`https://exptech.com.tw/api/v1/et/info?token=${params.token}`)
                .then(async res => {
                    const data = await res.json();
                    document.getElementById("coin").textContent = data.coin;
                    document.getElementById("client").textContent = data.client;
                    document.getElementById("service").textContent = data.service;
                    document.getElementById("subscribe").textContent = data.subscribe;
                    document.getElementById("key").textContent = JSON.stringify(data.key);
                    document.getElementById("key_list").textContent = JSON.stringify(data.key_list);
                    document.getElementById("client_list").textContent = JSON.stringify(data.client_list);
                    console.log(data);
                })
                .catch(err => {
                    console.error(err);
                    const res = err.request.response;
                    alert(res);
                });
        }

        load();
    </script>
</body>

</html>